<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, user-scalable=no"
  />
  <title>2Pick Mimic (Shadowverse: Worlds Beyond inspired)</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card-shadow{box-shadow:0 6px 20px rgba(0,0,0,.08)}
    .ring-sel{box-shadow:0 0 0 2px #a78bfa inset}
    .tile:hover{transform:translateY(-2px)}
    .transition-base{transition:all .18s ease}
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-900">
  <div class="max-w-6xl mx-auto px-4 py-6">
    <!-- Header -->
    <header class="flex items-center justify-between gap-3">
      <div>
        <h1 class="text-2xl font-bold">2Pick Mimicï¼ˆPrototype, Vanilla HTMLï¼‰</h1>
        <p class="text-sm text-slate-500">Shadowverse: Worlds Beyond ã®2Pickä½“é¨“ã®ã†ã¡ã€<span class="font-semibold">ã‚¯ãƒ©ã‚¹é¸æŠãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span>ã¨<span class="font-semibold">2æšãƒ”ãƒƒã‚¯Ã—30</span>ã®ã¿ã‚’å†ç¾</p>
      </div>
      <div class="flex items-center gap-2">
        <button id="btnReset" class="hidden px-3 py-2 text-sm rounded-xl border bg-white hover:bg-slate-50 transition-base">ãƒªã‚»ãƒƒãƒˆ</button>
      </div>
    </header>

    <!-- ============ PHASE: CLASS ============ -->
    <section id="phase-class" class="mt-6 grid md:grid-cols-3 gap-4">
      <div class="md:col-span-1">
        <div class="p-4 rounded-2xl border bg-white card-shadow sticky top-4">
          <h2 class="font-semibold mb-3">1) ã‚¯ãƒ©ã‚¹é¸æŠ</h2>
          <p class="text-sm text-slate-600 mb-3">
            å„ã‚¯ãƒ©ã‚¹ã‚’ã‚¿ãƒ–ã§åˆ‡æ›¿ â†’ <span class="font-semibold">ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰1æšä»¥ä¸Šã‚’å«ã‚€2æš</span>ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ç¢ºèªã—ã€
            ã€Œã“ã®ã‚¯ãƒ©ã‚¹ã§å§‹ã‚ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
          </p>
          <div class="space-y-2">
            <input id="seedInput" class="w-full px-3 py-2 rounded-lg border" placeholder="(ä»»æ„) ã‚·ãƒ¼ãƒ‰â€¦" />
            <p class="text-xs text-slate-500">â€» ãƒ‡ãƒ¢ã§ã¯ã‚·ãƒ¼ãƒ‰å€¤ã¯è¡¨ç¤ºã®ã¿ã§ã€ä¹±æ•°ã«ã¯æœªæ¥ç¶šã€‚</p>
          </div>
        </div>
      </div>
      <div class="md:col-span-2 space-y-4">
        <div id="classTabs" class="grid grid-cols-3 md:grid-cols-7 gap-2"></div>
        <div id="classPreview" class="space-y-4"></div>
      </div>
    </section>

    <!-- ============ PHASE: PICKING ============ -->
    <section id="phase-picking" class="hidden mt-6 grid md:grid-cols-3 gap-4">
      <div class="md:col-span-2 space-y-4">
        <div class="p-4 rounded-2xl border bg-white card-shadow">
          <div class="flex items-center justify-between mb-3">
            <div>
              <h2 class="font-semibold">2) 2æšã‹ã‚‰1æšã‚’Pick</h2>
              <p class="text-sm text-slate-600">ã‚¯ãƒ©ã‚¹: <span id="pickedClass" class="font-semibold"></span></p>
            </div>
            <div class="w-44">
              <div class="w-full h-2 rounded-full bg-slate-100 overflow-hidden">
                <div id="progressBar" class="h-full bg-indigo-400" style="width:0%"></div>
              </div>
              <div id="progressText" class="text-xs text-right mt-1 text-slate-500">0 / 30</div>
            </div>
          </div>

          <div id="pickPair" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

          <p id="remainingText" class="mt-4 text-xs text-slate-500">æ®‹ã‚Š 30 æšé¸æŠ</p>
        </div>
      </div>

      <div class="md:col-span-1 space-y-4">
        <div class="p-4 rounded-2xl border bg-white card-shadow">
          <div class="flex items-center justify-between">
            <h3 class="text-sm font-bold">Picked Deck (<span id="deckCount">0</span>/30)</h3>
            <div class="flex items-center gap-2">
              <button id="btnCopy" class="px-2 py-1 text-sm rounded-lg border bg-white hover:bg-slate-50 transition-base">Copy</button>
              <button id="btnSave" class="px-2 py-1 text-sm rounded-lg border bg-white hover:bg-slate-50 transition-base">Save .txt</button>
            </div>
          </div>
          <div class="rounded-xl border bg-white max-h-72 overflow-auto mt-2">
            <ul id="deckList" class="text-sm divide-y"></ul>
          </div>
        </div>

        <div class="p-4 rounded-2xl border bg-white card-shadow">
          <h3 class="text-sm font-bold mb-2">ãƒ«ãƒ¼ãƒ«ï¼ˆæœ¬ã‚µã‚¤ãƒˆã®ä»•æ§˜ï¼‰</h3>
          <ul class="text-sm list-disc pl-5 space-y-1 text-slate-600">
            <li>2æšã®æç¤ºã‹ã‚‰1æšã‚’é¸ã³ã€30æšã«ãªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—</li>
            <li>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯å„ã‚¯ãƒ©ã‚¹ã§ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰ã‚’å¿…ãšå«ã‚€2æš</li>
            <li>ãƒ‡ãƒ¢ã§ã¯ã‚«ãƒ¼ãƒ‰å‡ºç¾ã¯å®Œå…¨ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆé‡è¤‡ã‚ã‚Šï¼‰</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ============ PHASE: DONE ============ -->
    <section id="phase-done" class="hidden mt-6 grid md:grid-cols-3 gap-4">
      <div class="md:col-span-2 space-y-4">
        <div class="p-6 rounded-2xl border bg-white card-shadow text-center space-y-3">
          <h2 class="text-xl font-bold">ãƒ‡ãƒƒã‚­å®Œæˆï¼</h2>
          <p class="text-slate-600">ã‚¯ãƒ©ã‚¹: <span id="doneClass" class="font-semibold"></span> ï¼ æšæ•°: 30</p>
          <div class="flex items-center justify-center gap-2">
            <button id="btnAgain" class="px-3 py-2 rounded-xl border bg-white hover:bg-slate-50 transition-base">ã‚‚ã†ä¸€åº¦</button>
          </div>
        </div>
      </div>
      <div class="md:col-span-1">
        <div class="p-4 rounded-2xl border bg-white card-shadow">
          <div class="flex items-center justify-between">
            <h3 class="text-sm font-bold">Picked Deck (30/30)</h3>
            <div class="flex items-center gap-2">
              <button id="btnCopy2" class="px-2 py-1 text-sm rounded-lg border bg-white hover:bg-slate-50 transition-base">Copy</button>
              <button id="btnSave2" class="px-2 py-1 text-sm rounded-lg border bg-white hover:bg-slate-50 transition-base">Save .txt</button>
            </div>
          </div>
          <div class="rounded-xl border bg-white max-h-72 overflow-auto mt-2">
            <ul id="deckListDone" class="text-sm divide-y"></ul>
          </div>
        </div>
      </div>
    </section>

    <footer class="mt-10 text-center text-xs text-slate-500">
      â€» æœ¬ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã¯ãƒ•ã‚¡ãƒ³ãƒ¡ã‚¤ãƒ‰ã®UIãƒ‡ãƒ¢ã§ã™ã€‚å…¬å¼ã‚¢ã‚»ãƒƒãƒˆãƒ»å®Ÿã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã¯å«ã¿ã¾ã›ã‚“ã€‚
    </footer>
  </div>

  <script>
    // -------------------- Data --------------------
    const CLASSES = ["Elf","Royal","Witch","Dragon","Nightmare","Bishop","Nemesis"];

    // Minimal mock pool (id, name, class, rarity[L/G/S/B], cost, type, text)
    const MOCK_CARDS = [
      // Elf
      { id:"elf-l1", name:"æ£®ç¾…ã®è¦‡ç²¾ ã‚¨ãƒ«ãƒ”ã‚¹", class:"Elf", rarity:"L", cost:7, type:"Follower", text:"+2/+2 if played after 2 cards." },
      { id:"elf-l2", name:"ç¿ é¢¨ã®å°ãæ‰‹", class:"Elf", rarity:"L", cost:6, type:"Follower", text:"Draw 1 on evolve." },
      { id:"elf-g1", name:"å¦–ç²¾ã®å¥³ç‹", class:"Elf", rarity:"G", cost:5, type:"Follower", text:"Summon 2 Fairies." },
      { id:"elf-s1", name:"æ£®ã®æ„å¿—", class:"Elf", rarity:"S", cost:6, type:"Spell", text:"Deal 2 to all enemies." },
      { id:"elf-b1", name:"ãƒ•ã‚§ã‚¢ãƒªãƒ¼", class:"Elf", rarity:"B", cost:1, type:"Follower", text:"A tiny spirit of the woods." },

      // Royal
      { id:"roy-l1", name:"é¨å£«ç‹ ã‚ªãƒ¼ã‚®ãƒ¥ã‚¹ãƒˆ", class:"Royal", rarity:"L", cost:7, type:"Follower", text:"Give allied followers +1/+1." },
      { id:"roy-l2", name:"ç™½éŠ€ã®è¦‡è€…", class:"Royal", rarity:"L", cost:8, type:"Follower", text:"Storm." },
      { id:"roy-g1", name:"ãƒ–ãƒ¬ãƒ¼ãƒ‰ã‚³ãƒãƒ³ãƒ€ãƒ¼", class:"Royal", rarity:"G", cost:5, type:"Follower", text:"Enhance soldiers." },
      { id:"roy-s1", name:"æ¸¾èº«ã®ä¸€æŒ¯ã‚Š", class:"Royal", rarity:"S", cost:2, type:"Spell", text:"Deal 3 to a follower." },
      { id:"roy-b1", name:"å…µå£«", class:"Royal", rarity:"B", cost:2, type:"Follower", text:"The backbone of the army." },

      // Witch
      { id:"wit-l1", name:"è¶…è¶Šã®å¤§é­”é“å£«", class:"Witch", rarity:"L", cost:9, type:"Follower", text:"Reduce spells by 1." },
      { id:"wit-l2", name:"æ¥µå…‰ã®éŒ¬é‡‘è¡“å¸«", class:"Witch", rarity:"L", cost:6, type:"Follower", text:"Spellboost synergy." },
      { id:"wit-g1", name:"é­”å°ã®å·¨å…µ", class:"Witch", rarity:"G", cost:7, type:"Follower", text:"Ward." },
      { id:"wit-s1", name:"çŸ¥æµã®å…‰", class:"Witch", rarity:"S", cost:1, type:"Spell", text:"Draw 1." },
      { id:"wit-b1", name:"é­”è¡“å¸«è¦‹ç¿’ã„", class:"Witch", rarity:"B", cost:2, type:"Follower", text:"Spellboost: +1/+0." },

      // Dragon
      { id:"dra-l1", name:"è¦‡ç‚é¾ ãƒãƒãƒ ãƒ¼ãƒˆ", class:"Dragon", rarity:"L", cost:10, type:"Follower", text:"Destroy all other followers." },
      { id:"dra-l2", name:"è’¼ç¿¼ã®è¦‡è€…", class:"Dragon", rarity:"L", cost:8, type:"Follower", text:"Ramp 1." },
      { id:"dra-g1", name:"ãƒ‰ãƒ©ã‚´ãƒ³ãƒŠã‚¤ãƒˆ", class:"Dragon", rarity:"G", cost:5, type:"Follower", text:"Bane." },
      { id:"dra-s1", name:"ãƒ–ãƒ¬ã‚¤ã‚¸ãƒ³ã‚°ãƒ–ãƒ¬ã‚¹", class:"Dragon", rarity:"S", cost:1, type:"Spell", text:"Deal 2 to a follower." },
      { id:"dra-b1", name:"ç«œã®è¨—å®£", class:"Dragon", rarity:"B", cost:2, type:"Spell", text:"Gain 1 play point orb." },

      // Nightmare
      { id:"nig-l1", name:"å†¥ç•Œã®ä¸» ãƒãƒ‡ã‚¹", class:"Nightmare", rarity:"L", cost:9, type:"Follower", text:"If X >= 20, win the game." },
      { id:"nig-l2", name:"å¸è¡€å§« ãƒ´ã‚¡ãƒ³ãƒ”ã‚£", class:"Nightmare", rarity:"L", cost:3, type:"Follower", text:"Deal 1 to both leaders." },
      { id:"nig-g1", name:"å¤œã®çœ·å±", class:"Nightmare", rarity:"G", cost:4, type:"Follower", text:"Lifedrain." },
      { id:"nig-s1", name:"ã‚½ã‚¦ãƒ«ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³", class:"Nightmare", rarity:"S", cost:2, type:"Spell", text:"Draw 2, destroy allied follower." },
      { id:"nig-b1", name:"ãƒ´ã‚¡ãƒ³ãƒ‘ã‚¤ã‚¢ãƒãƒƒãƒˆ", class:"Nightmare", rarity:"B", cost:1, type:"Follower", text:"A pesky bat." },

      // Bishop
      { id:"bis-l1", name:"å‰µä¸–ã®è–å¥³", class:"Bishop", rarity:"L", cost:7, type:"Follower", text:"Heal 3 to leader." },
      { id:"bis-l2", name:"ã‚¸ãƒ£ãƒ³ãƒŒãƒ€ãƒ«ã‚¯", class:"Bishop", rarity:"L", cost:6, type:"Follower", text:"Deal 3 to all enemies." },
      { id:"bis-g1", name:"è–ãªã‚‹é¡˜ã„", class:"Bishop", rarity:"G", cost:2, type:"Amulet", text:"Draw over turns." },
      { id:"bis-s1", name:"è© å”±ï¼šç™½ç¿¼ã¸ã®ç¥ˆã‚Š", class:"Bishop", rarity:"S", cost:1, type:"Amulet", text:"Countdown 3, summon 2/2." },
      { id:"bis-b1", name:"ä¿®é“å¥³", class:"Bishop", rarity:"B", cost:2, type:"Follower", text:"Ward." },

      // Nemesis
      { id:"nem-l1", name:"æ©Ÿæ§‹ã®è§£æ”¾è€…", class:"Nemesis", rarity:"L", cost:7, type:"Follower", text:"Accelerate synergy." },
      { id:"nem-l2", name:"çµ¶å‚‘ãƒ»ãƒªãƒ¼ã‚·ã‚§ãƒŠ", class:"Nemesis", rarity:"L", cost:8, type:"Follower", text:"Artifact synergy." },
      { id:"nem-g1", name:"ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®åŒèª¿", class:"Nemesis", rarity:"G", cost:2, type:"Spell", text:"Generate artifacts." },
      { id:"nem-s1", name:"é‡ç”£", class:"Nemesis", rarity:"S", cost:2, type:"Spell", text:"Copy a card in hand." },
      { id:"nem-b1", name:"ã‚¢ãƒŠãƒ©ã‚¤ã‚ºã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ", class:"Nemesis", rarity:"B", cost:2, type:"Follower", text:"Draw 1 on death." },
    ];

    // -------------------- Helpers --------------------
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => Array.from(document.querySelectorAll(q));

    const poolByClass = (cls) => MOCK_CARDS.filter(c => c.class === cls);
    const legendsByClass = (cls) => poolByClass(cls).filter(c => c.rarity === "L");
    const rngPick = (arr) => arr[Math.floor(Math.random() * arr.length)];

    function twoCardPreviewForClass(cls){
      const legends = legendsByClass(cls);
      const pool = poolByClass(cls);
      const first = rngPick(legends);
      let second = rngPick(pool);
      let i=0;
      while(second.id === first.id && i<10){
        second = rngPick(pool); i++;
      }
      return [first, second];
    }

    function rollTwo(pool){
      let a = rngPick(pool);
      let b = rngPick(pool);
      let i=0;
      while(b.id === a.id && i<10){
        b = rngPick(pool); i++;
      }
      return [a,b];
    }

    function rarityBadge(r){
      const map = {
        L: "from-yellow-200 to-yellow-400 text-yellow-900",
        G: "from-amber-200 to-amber-400 text-amber-900",
        S: "from-zinc-200 to-zinc-300 text-zinc-900",
        B: "from-stone-200 to-stone-300 text-stone-900",
      };
      return `<span class="px-2 py-0.5 rounded-md text-xs font-semibold bg-gradient-to-r ${map[r]}">${r}</span>`;
    }

    function cardTile(card, withButton=false, btnLabel="ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’é¸ã¶", btnId=""){
      return `
        <div class="transition-base tile">
          <div class="cursor-pointer overflow-hidden rounded-2xl border bg-white card-shadow ${card.rarity==='L'?'ring-sel':''}">
            <div class="h-28 w-full bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center">
              <span class="text-4xl">ğŸ´</span>
            </div>
            <div class="p-3 space-y-2">
              <div class="flex items-center gap-2">
                ${rarityBadge(card.rarity)}
                <span class="text-xs px-2 py-0.5 rounded-full bg-slate-100 border">${card.class}</span>
                <span class="ml-auto text-xs font-mono">PP ${card.cost}</span>
              </div>
              <div class="text-sm font-semibold leading-tight">${card.name}</div>
              <p class="text-xs text-slate-500 line-clamp-2">${card.text}</p>
            </div>
          </div>
          ${withButton ? `
            <div class="mt-2">
              <button id="${btnId}" class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm hover:bg-indigo-700 transition-base">${btnLabel}</button>
            </div>` : ``}
        </div>
      `;
    }

    function renderDeckList(ulEl, cards){
      const map = new Map();
      for(const c of cards) map.set(c.name, (map.get(c.name)||0)+1);
      const rows = Array.from(map.entries()).sort((a,b)=>a[0].localeCompare(b[0]));
      ulEl.innerHTML = rows.map(([name, ct]) => `
        <li class="px-3 py-2 flex items-center justify-between">
          <span>${name}</span>
          <span class="text-xs font-mono px-2 py-0.5 rounded bg-slate-100 border">x${ct}</span>
        </li>
      `).join("");
      return rows.map(r => `${r[0]} x${r[1]}`).join("\n");
    }

    // -------------------- State --------------------
    let phase = "class"; // class | picking | done
    let selectedClass = null;
    let preview = {}; // { className: [card, card] }
    let deck = [];
    let pair = [];

    // -------------------- DOM refs --------------------
    const phaseClass = $("#phase-class");
    const phasePicking = $("#phase-picking");
    const phaseDone = $("#phase-done");
    const btnReset = $("#btnReset");
    const classTabs = $("#classTabs");
    const classPreview = $("#classPreview");
    const seedInput = $("#seedInput");

    const pickedClassEl = $("#pickedClass");
    const progressBar = $("#progressBar");
    const progressText = $("#progressText");
    const pickPair = $("#pickPair");
    const remainingText = $("#remainingText");
    const deckList = $("#deckList");
    const deckCount = $("#deckCount");
    const btnCopy = $("#btnCopy");
    const btnSave = $("#btnSave");

    const doneClassEl = $("#doneClass");
    const deckListDone = $("#deckListDone");
    const btnCopy2 = $("#btnCopy2");
    const btnSave2 = $("#btnSave2");
    const btnAgain = $("#btnAgain");

    // -------------------- Phase control --------------------
    function setPhase(p){
      phase = p;
      phaseClass.classList.toggle("hidden", p!=="class");
      phasePicking.classList.toggle("hidden", p!=="picking");
      phaseDone.classList.toggle("hidden", p!=="done");
      btnReset.classList.toggle("hidden", p==="class");
    }

    function resetAll(){
      selectedClass = null;
      deck = [];
      pair = [];
      preview = Object.fromEntries(CLASSES.map(c => [c, twoCardPreviewForClass(c)]));
      renderClassPhase();
      setPhase("class");
    }

    // -------------------- Rendering --------------------
    function renderClassPhase(active = CLASSES[0]){
      // Tabs
      classTabs.innerHTML = CLASSES.map(c => `
        <button data-class="${c}" class="px-3 py-2 rounded-xl border text-sm bg-white hover:bg-slate-50 transition-base ${c===active?'bg-slate-100 border-slate-300':''}">
          ${c}
        </button>
      `).join("");

      // Preview
      const cards = preview[active] || twoCardPreviewForClass(active);
      preview[active] = cards; // cache
      classPreview.innerHTML = `
        <div class="flex items-center justify-between">
          <h3 class="font-semibold">${active} â€” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
          <button id="btnStartClass" class="px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm hover:bg-indigo-700 transition-base">ã“ã®ã‚¯ãƒ©ã‚¹ã§å§‹ã‚ã‚‹</button>
        </div>
        <div class="grid grid-cols-2 gap-3">
          ${cards.map((c, idx) => cardTile(c, false, "", `pv-${idx}`)).join("")}
        </div>
      `;

      // bind
      $$("#classTabs button").forEach(btn=>{
        btn.addEventListener("click", () => renderClassPhase(btn.dataset.class));
      });
      $("#btnStartClass").addEventListener("click", () => startWithClass(active));
    }

    function startWithClass(cls){
      selectedClass = cls;
      setPhase("picking");
      deck = [];
      pair = rollTwo(poolByClass(cls));
      renderPicking();
    }

    function renderPicking(){
      pickedClassEl.textContent = selectedClass;
      const pct = Math.round((deck.length/30)*100);
      progressBar.style.width = pct + "%";
      progressText.textContent = `${deck.length} / 30`;
      remainingText.textContent = `æ®‹ã‚Š ${30 - deck.length} æšé¸æŠ`;
      deckCount.textContent = deck.length;

      // pair
      pickPair.innerHTML = pair.map((c, i) => `
        <div>${cardTile(c, true, "ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’é¸ã¶", "pick-"+i)}</div>
      `).join("");

      // bind pair buttons
      pair.forEach((c, i) => {
        $("#pick-"+i).addEventListener("click", () => pickCard(c));
      });

      // deck list
      renderDeckList(deckList, deck);
    }

    function pickCard(card){
      deck.push(card);
      if(deck.length >= 30){
        renderDone();
        setPhase("done");
        return;
      }
      pair = rollTwo(poolByClass(selectedClass));
      renderPicking();
    }

    function renderDone(){
      doneClassEl.textContent = selectedClass;
      const txt = renderDeckList(deckListDone, deck);
      // Also refresh picking panel (counts frozen at 30)
      renderPicking();

      // Bind copy/save both places
      const doCopy = async () => {
        const text = renderDeckList(deckList, deck);
        try{ await navigator.clipboard.writeText(text); alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"); }
        catch{ alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ"); }
      };
      const doCopy2 = async () => {
        const text = renderDeckList(deckListDone, deck);
        try{ await navigator.clipboard.writeText(text); alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"); }
        catch{ alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ"); }
      };
      const doSave = () => {
        const text = renderDeckList(deckList, deck);
        const blob = new Blob([text], {type:"text/plain;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "decklist.txt"; a.click();
        URL.revokeObjectURL(url);
      };
      const doSave2 = () => {
        const text = renderDeckList(deckListDone, deck);
        const blob = new Blob([text], {type:"text/plain;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "decklist.txt"; a.click();
        URL.revokeObjectURL(url);
      };

      btnCopy.onclick = doCopy;
      btnSave.onclick = doSave;
      btnCopy2.onclick = doCopy2;
      btnSave2.onclick = doSave2;
    }

    // -------------------- Global bindings --------------------
    btnReset.addEventListener("click", resetAll);
    btnAgain.addEventListener("click", resetAll);

    btnCopy.addEventListener("click", async ()=>{
      const text = renderDeckList(deckList, deck);
      try{ await navigator.clipboard.writeText(text); alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"); }
      catch{ alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ"); }
    });

    btnSave.addEventListener("click", ()=>{
      const text = renderDeckList(deckList, deck);
      const blob = new Blob([text], {type:"text/plain;charset=utf-8"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "decklist.txt"; a.click();
      URL.revokeObjectURL(url);
    });

    // -------------------- Init --------------------
    resetAll();               // state + previewç”Ÿæˆ
    renderClassPhase();       // åˆå›æç”»
    setPhase("class");        // ç”»é¢è¡¨ç¤º
  </script>
</body>
</html>
